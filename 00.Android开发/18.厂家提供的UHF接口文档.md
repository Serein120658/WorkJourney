# UniUHF 超高频 RFID 接口文档

## 1. 插件引入

### 1.1 获取插件实例

```javascript
const plugin = uni.requireNativePlugin('UniUHF')
```

**说明：** **在使用任何接口前，必须先通过 `uni.requireNativePlugin` 方法获取 UniUHF 插件实例。**

------

## 2. 基础接口

### 2.1 initUHFManager()

**功能：** 初始化超高频模块

**返回值：**

- `1` - 初始化成功
- `0` - 初始化失败

**使用示例：**

```javascript
const result = plugin.initUHFManager();
if (result === 1 || result === true ) {
    console.log('超高频模块初始化成功');
} else {
    console.log('超高频模块初始化失败');
}
```

**注意事项：**

- **必须在页面 `onShow` 生命周期中调用**
- 初始化成功后才能使用其他接口

------

### 2.2 uninitUHFManager()

**功能：** 反初始化超高频模块，释放资源

**返回值：** 无

**使用示例：**

```javascript
plugin.uninitUHFManager();
```

**注意事项：**

- **应在页面 `onHide` 或 `onBackPress` 中调用**
- 退出页面前必须调用，否则可能导致资源泄漏

------

### 2.3 startInventory()

**功能：** 开始盘点标签

**返回值：**

- `true` - 启动成功
- `false` - 启动失败

**使用示例：**

```javascript
const result = plugin.startInventory();
if (result) {
    console.log('开始盘点');
} else {
    console.log('启动盘点失败');
}
```

**数据接收：** **读取到的标签数据会通过广播 `uni.pda.uhf.data` 发送，需要注册广播接收器接收数据。**

**广播数据格式：**

```
[epc,tid,rssi,freq][epc,tid,rssi,freq]...
```

每个标签数据由 `[]` 包围，字段之间用逗号分隔。

------

### 2.4 stopInventory()

**功能：** 停止盘点标签

**返回值：**

- `true` - 停止成功
- `false` - 停止失败

**使用示例：**

```javascript
const result = plugin.stopInventory();
if (result) {
    console.log('停止盘点');
}
```

------

### 2.5 setUHFPower(int powerlevel)

**功能：** 设置读写器功率

**参数：**

- ```
  powerlevel
  ```

   (int) - 功率值，需要乘以 100

  - 例如：设置 22dB 需要传入 2200
  - **范围：通常为 5dB ~ 30dB（500 ~ 3300）**

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
// 设置功率为 22dB
const result = plugin.setUHFPower(2200);

// 设置功率为 26dB
const result = plugin.setUHFPower(2600);
```

**注意事项：**

- 功率越大，读取距离越远，但功耗也越大
- 建议根据实际应用场景调整功率

------

### 2.6 setUHFSession(int session)

**功能：** 设置 Session 参数

**参数：**

- ```
  session
  ```

   (int) - Session 值

  - `0` - Session 0
  - `1` - Session 1

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
const result = plugin.setUHFSession(0);
```

**说明：** Session 参数影响标签的防冲突算法和读取效率。

------

### 2.7 setUHFZone(int zone)

**功能：** 设置频段区域

**参数：**

- ```
  zone
  ```

   (int) - 区域代码

  - `1` - 南美
  - `2` - 欧盟
  - `6` - 中国（840MHz~845MHz 和 920MHz~925MHz）
  - `255` - 全频段

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
// 设置为中国区域
const result = plugin.setUHFZone(6);
```

**注意事项：**

- 必须根据所在国家/地区设置正确的频段
- 使用错误的频段可能违反当地法规

------

### 2.8 setUHFTarget(int target)

**功能：** 设置 Target 参数

**参数：**

- ```
  target
  ```

   (int) - Target 值（0~3）

  - `0` - A
  - `1` - B
  - `2` - A→B
  - `3` - B→A

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
const result = plugin.setUHFTarget(0);
```

**说明：** Target 参数用于标签状态切换，影响标签的响应策略。

------

### 2.9 setUHFInventoryMode(int mode)

**功能：** 设置盘点模式

**参数：**

- ```
  mode
  ```

   (int) - 盘点模式

  - `0` - 普通模式（适用于一般场景）
  - `1` - 新快速模式（提高盘点速度）
  - `2` - 单标签模式（仅读取单个标签）
  - `3` - E7 读停模式
  - `4` - E7 智能温控模式
  - `5` - 多标签模式（高密度标签环境）

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
// 设置为快速模式
const result = plugin.setUHFInventoryMode(1);
```

**建议：**

- 标签数量少时使用单标签模式
- 标签数量多时使用多标签模式或快速模式

------

### 2.10 setUHFRFMode(int RFMode)

**功能：** 设置模块 RF 模式

**参数：**

- ```
  RFMode
  ```

   (int) - RF 模式（0~10）

  - `0` - 203/Tari(6.25μs)/DSB/FM0/640kHz
  - `1` - 111/Tari(7.5μs)/PR/FM0/640kHz
  - `2` - 220/Tari(6.25μs)/DSB/M2/640kHz
  - `3` - 101/Tari(7.5μs)/PR/M2/640kHz
  - `4` - 45/Tari(7.5μs)/PR/M4/640kHz
  - `5` - 115/Tari(7.5μs)/PR/M4/640kHz
  - `6` - 112/Tari(15μs)/PR/M2/320kHz
  - `7` - 103/Tari(20μs)/PR/M2/320kHz
  - `8` - 105/Tari(20μs)/PR/M4/320kHz
  - `9` - 107/Tari(20μs)/PR/M4/250kHz
  - `10` - 113/Tari(20μs)/PR/M8/160kHz

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
const result = plugin.setUHFRFMode(3);
```

**说明：** **RF 模式影响读取速度和兼容性，建议使用默认值。**

------

### 2.11 setAudioTip(boolean allow)

**功能：** 设置是否允许播放提示音

**参数：**

- ```
  allow
  ```

   (boolean)

  - `true` - 允许播放提示音
  - `false` - 禁止播放提示音

**返回值：**

- `true` - 设置成功
- `false` - 设置失败

**使用示例：**

```javascript
// 开启提示音
plugin.setAudioTip(true);

// 关闭提示音
plugin.setAudioTip(false);
```

------

## 3. 标签操作接口

### 3.1 getTidByEpc(String epc)

**功能：** 根据 EPC 获取标签 TID

**参数：**

- `epc` (String) - 标签的 EPC 值

**返回值：**

- (String) - TID 值，如果获取失败返回空字符串

**使用示例：**

```javascript
const tid = plugin.getTidByEpc('E280689400005000221E334923');
console.log('TID:', tid);
```

**前提条件：**

- 标签必须有 TID 数据
- 必须已经读取过该标签

------

### 3.2 readTagInfo()

**功能：** 读取标签指定存储区的数据

**参数：**

```javascript
plugin.readTagInfo(
    startaddr,        // int - 读取开始地址（字地址）
    blocks,           // int - 读取的块数（每块2字节）
    rpaswdstring,     // String - 访问密码（8位十六进制，默认为"00000000"）
    filterbank,       // int - 过滤存储区（1=EPC, 2=TID, 3=User）
    filter_address,   // String - 过滤区起始地址
    filterdata,       // String - 过滤数据（用于匹配标签）
    rbank             // int - 需要读取的存储区（0=保留区, 1=EPC, 2=TID, 3=User）
)
```

**返回值：**

- (String) - 读取到的数据（十六进制字符串），失败返回空字符串

**使用示例：**

```javascript
// 读取 EPC 区数据
const data = plugin.readTagInfo(
    2,              // 从地址2开始
    6,              // 读取6个字（12字节）
    "00000000",     // 访问密码
    1,              // 按EPC过滤
    "2",            // EPC区起始地址
    "E28068",       // 过滤数据（EPC前缀）
    1               // 读取EPC区
);
console.log('读取数据:', data);
```

**注意事项：**

- 地址和块数需要根据标签规格确定
- 访问密码错误会导致读取失败

------

### 3.3 writeTagInfo()

**功能：** 向标签指定存储区写入数据

**参数：**

```javascript
plugin.writeTagInfo(
    wpaswdstring,     // String - 写密码（8位十六进制）
    filterbank,       // int - 过滤存储区
    filter_address,   // String - 过滤区起始地址
    filterdata,       // String - 过滤数据
    wbank,            // int - 需要写入的存储区
    write_startaddr,  // int - 写入起始地址
    wdataString       // String - 写入数据（十六进制字符串）
)
```

**返回值：**

- `true` - 写入成功
- `false` - 写入失败

**使用示例：**

```javascript
// 写入用户数据区
const result = plugin.writeTagInfo(
    "00000000",           // 写密码
    1,                    // 按EPC过滤
    "2",                  // EPC区地址
    "E280689400005000",   // 要操作的标签EPC
    3,                    // 写入User区
    0,                    // 从地址0开始
    "1234567890ABCDEF"    // 写入的数据
);

if (result) {
    console.log('写入成功');
} else {
    console.log('写入失败');
}
```

**注意事项：**

- 写入前确保密码正确
- 某些区域可能被锁定，无法写入
- 写入数据长度必须是字的整数倍（2字节）

------

### 3.4 lockTag()

**功能：** 锁定标签指定存储区

**参数：**

```javascript
plugin.lockTag(
    lbank,            // int - 锁定的存储区
    ltype,            // int - 锁类型（0=解锁, 1=锁定, 2=永久锁定, 3=永久解锁）
    lockpaswdString,  // String - 锁密码（8位十六进制）
    filterbank,       // int - 过滤存储区
    filter_address,   // String - 过滤区起始地址
    filterdata        // String - 过滤数据
)
```

**返回值：**

- `true` - 锁定成功
- `false` - 锁定失败

**使用示例：**

```javascript
// 锁定 EPC 区
const result = plugin.lockTag(
    1,                    // 锁定EPC区
    1,                    // 锁定类型：锁定
    "00000000",           // 锁密码
    1,                    // 按EPC过滤
    "2",                  // EPC区地址
    "E280689400005000"    // 标签EPC
);
```

**警告：**

- 永久锁定操作不可逆，请谨慎使用
- 锁定后需要正确密码才能解锁

------

### 3.5 killTag()

**功能：** 销毁标签（使标签永久失效）

**参数：**

```javascript
plugin.killTag(
    lockpaswdString,  // String - Kill 密码（8位十六进制）
    filterbank,       // int - 过滤存储区
    filter_address,   // String - 过滤区起始地址
    filterdata        // String - 过滤数据
)
```

**返回值：**

- `true` - 销毁成功
- `false` - 销毁失败

**使用示例：**

```javascript
// 销毁指定标签
const result = plugin.killTag(
    "12345678",           // Kill密码
    1,                    // 按EPC过滤
    "2",                  // EPC区地址
    "E280689400005000"    // 标签EPC
);
```

**危险警告：**

- 此操作会永久销毁标签，标签将无法再被读取
- 请确保 Kill 密码正确且确实需要销毁标签
- 建议在生产环境中限制此功能的使用权限

------

## 4. 广播接收

### 4.1 按键广播

**广播 Action:** `com.pda.keycode.broacast`

**数据字段：**

- ```
  keycode
  ```

   (int) - 按键键值

  - `292` - 手柄扫描键

- ```
  isdown
  ```

   (boolean) - 按键状态

  - `true` - 按下
  - `false` - 抬起

**处理示例：**

```javascript
if (m_action == "com.pda.keycode.broacast") {
    let keycode = intent.getIntExtra("keycode", 0);
    let iskeydown = intent.getBooleanExtra("isdown", false);
    
    if (keycode == 292) {
        if (iskeydown) {
            plugin.startInventory();  // 按下开始盘点
        } else {
            plugin.stopInventory();   // 抬起停止盘点
        }
    }
}
```

------

### 4.2 标签数据广播

**广播 Action:** `uni.pda.uhf.data`

**数据字段：**

- `uhfdata` (String) - 标签数据字符串

**数据格式：**

```
[epc,tid,rssi,freq][epc,tid,rssi,freq]...
```

**字段说明：**

- `epc` - 标签 EPC 码（电子产品码）
- `tid` - 标签 TID（标签唯一识别码）
- `rssi` - 信号强度（负数，越接近0信号越强）
- `freq` - 频率

**解析示例：**

```javascript
if (m_action == "uni.pda.uhf.data") {
    let uhfdata = intent.getStringExtra("uhfdata");
    
    // 解析标签数据
    const tagPattern = /\[(.*?)\]/g;
    let match;
    
    while ((match = tagPattern.exec(uhfdata)) !== null) {
        const tagData = match[1].split(',');
        const tag = {
            epc: tagData[0],
            tid: tagData[1],
            rssi: tagData[2],
            freq: tagData[3]
        };
        
        console.log('标签:', tag);
        // 处理标签数据...
    }
}
```

------

## 5. 完整使用流程

### 5.1 初始化流程

```javascript
// 1. 获取插件
const plugin = uni.requireNativePlugin('UniUHF');

// 2. 初始化模块
const result = plugin.initUHFManager();
if (result === 1) {
    // 3. 配置参数
    plugin.setUHFPower(2600);        // 设置功率26dB
    plugin.setUHFZone(6);            // 设置中国区域
    plugin.setUHFInventoryMode(1);   // 快速模式
    plugin.setAudioTip(true);        // 开启提示音
}

// 4. 注册广播接收器
this.registerReceiver();
```

### 5.2 盘点流程

```javascript
// 开始盘点
plugin.startInventory();

// 接收标签数据（通过广播）
// 在 onReceive 方法中处理数据

// 停止盘点
plugin.stopInventory();
```

### 5.3 退出流程

```javascript
// 1. 停止盘点
plugin.stopInventory();

// 2. 注销广播接收器
this.unregisterReceiver();

// 3. 反初始化
plugin.uninitUHFManager();
```

------

## 6. 常见问题

### Q1: 初始化失败怎么办？

**A:**

- 检查设备是否支持超高频功能
- 确保在 `onShow` 生命周期中调用
- 检查是否有其他应用占用了超高频模块

### Q2: 读取不到标签怎么办？

**A:**

- 检查功率设置是否合适
- 确认标签与读写器距离
- 检查频段设置是否正确
- 尝试调整盘点模式

### Q3: 如何提高读取速度？

**A:**

- 使用快速模式或多标签模式
- 适当提高功率
- 减少不必要的数据读取
- 优化过滤条件

### Q4: 如何避免重复读取？

**A:**

- 在应用层使用 Set 或 Map 去重
- 使用 EPC 作为唯一标识
- 记录已读取的标签

------

## 7. 最佳实践

1. **资源管理**
   - 页面隐藏时及时调用 `uninitUHFManager()`
   - 退出应用前清理资源
2. **错误处理**
   - 所有接口调用都应检查返回值
   - 捕获异常并给用户友好提示
3. **性能优化**
   - 避免频繁初始化和反初始化
   - 合理设置功率，避免过度消耗电量
   - 使用防抖处理高频数据



## 8.DEMO运行

### 代码

```vue
<template>
	<view class="content">	
		<!-- 统计信息 -->
		<view class="stats-container">
			<view class="stat-item">
				<text class="stat-label">标签数:</text>
				<text class="stat-value">{{ uniqueTagCount }}</text>
			</view>
			<view class="stat-item">
				<text class="stat-label">读取次数:</text>
				<text class="stat-value">{{ totalReadCount }}</text>
			</view>
			<view class="stat-item">
				<text class="stat-label">耗时:</text>
				<text class="stat-value">{{ formatTime(elapsedTime) }}</text>
			</view>
		</view>
		
		<!-- 表格 -->
		<view class="table-container">
			<view class="table">
				<!-- 表头 -->
				<view class="table-header">
					<view class="table-cell" style="flex: 2;">EPC</view>
					<view class="table-cell" style="flex: 1.5;">TID</view>
					<view class="table-cell" style="flex: 0.8;">RSSI</view>
					<view class="table-cell" style="flex: 0.8;">次数</view>
				</view>
				
				<!-- 表格内容 -->
				<scroll-view class="table-body" scroll-y="true">
					<view v-for="(tag, index) in tagList" :key="tag.epc" class="table-row">
						<view class="table-cell" style="flex: 2;">
							<text class="epc-text">{{ tag.epc }}</text>
							<text class="tid-text">{{ tag.tid }}</text>
						</view>
						<view class="table-cell" style="flex: 1.5;">
							<text class="cell-text">{{ tag.tid || '-' }}</text>
						</view>
						<view class="table-cell" style="flex: 0.8;">
							<text class="cell-text">{{ tag.rssi }}</text>
						</view>
						<view class="table-cell" style="flex: 0.8;">
							<text class="cell-text">{{ tag.count }}</text>
						</view>
					</view>
					
					<!-- 空状态 -->
					<view v-if="tagList.length === 0" class="empty-state">
						<text class="empty-text">{{ isScanning ? '正在扫描...' : '暂无数据' }}</text>
					</view>
				</scroll-view>
			</view>
		</view>
		
		<!-- 底部按钮 -->
		<view class="button-container">
			<button 
				class="btn btn-start" 
				:class="{ 'btn-active': isScanning }"
				@click="toggleScan"
			>
				{{ isScanning ? '停止' : '开始扫描' }}
			</button>
			<button class="btn btn-stop" @click="clearData">清空</button>
			<button class="btn btn-clear" @click="exportData">导出</button>
		</view>
	</view>
</template>

<script>
	const plugin = uni.requireNativePlugin('UniUHF');
	
	export default {
		data() {
			return {
				isScanning: false,          // 是否正在扫描
				tagMap: {},                 // 标签映射表 {epc: tagData}
				tagList: [],                // 标签列表（用于显示）
				totalReadCount: 0,          // 总读取次数
				uniqueTagCount: 0,          // 唯一标签数
				elapsedTime: 0,             // 已用时间（秒）
				timer: null,                // 计时器
				main: null,                 // Android主Activity
				receiver: null,             // 广播接收器
				filter: null                // 广播过滤器
			}
		},
		
		onLoad() {
			console.log('页面加载');
		},
		
		onShow() {
			console.log('页面显示');
			this.initUHF();
		},
		
		onHide() {
			console.log('页面隐藏');
			this.stopScan();
			this.uninitUHF();
		},
		
		onBackPress() {
			console.log('返回按钮');
			this.stopScan();
			this.uninitUHF();
		},
		
		beforeDestroy() {
			console.log('页面销毁');
			this.unregisterReceiver();
		},
		
		methods: {
			/**
			 * 初始化超高频模块
			 */
			initUHF() {
				// 初始化超高频模块
				const result = plugin.initUHFManager();
				
				if (result === 1 || result === true) {
					console.log('UHF初始化成功');
					
					// TODO 这部分后续需要创建一个配置文件  从配置中获取  这里就设置一个demo 配置参数
					plugin.setUHFPower(2600);           // 设置功率26dB
					plugin.setUHFZone(6);               // 设置中国区域
					plugin.setUHFInventoryMode(1);      // 快速模式
					plugin.setUHFSession(0);            // Session 0
					plugin.setAudioTip(true);           // 开启提示音
					
					// 注册广播接收器
					this.registerReceiver();
					
					uni.showToast({
						title: '初始化成功',
						icon: 'success',
						duration: 1500
					});
				} else {
					console.error('UHF初始化失败');
					uni.showToast({
						title: '初始化失败',
						icon: 'error',
						duration: 2000
					});
				}
			},
			
			/**
			 * 反初始化超高频模块
			 */
			uninitUHF() {
				if (plugin) {
					plugin.uninitUHFManager();
					console.log('UHF已反初始化');
				}
			},
			
			/**
			 * 注册广播接收器
			 */
			registerReceiver() {
				// #ifdef APP-PLUS
				this.main = plus.android.runtimeMainActivity();
				
				const IntentFilter = plus.android.importClass('android.content.IntentFilter');
				this.filter = new IntentFilter();
				this.filter.addAction("com.pda.keycode.broacast");    // 按键广播
				this.filter.addAction("uni.pda.uhf.data");            // 标签数据广播
				
				const _this = this;
				this.receiver = plus.android.implements('io.dcloud.feature.internal.reflect.BroadcastReceiver', {
					onReceive: function(context, intent) {
						plus.android.importClass(intent);
						const action = intent.getAction();
						
						// 处理按键广播
						if (action === "com.pda.keycode.broacast") {
							const keycode = intent.getIntExtra("keycode", 0);
							const isKeyDown = intent.getBooleanExtra("isdown", false);
							
							// 手柄按键292
							if (keycode === 292) {
								if (isKeyDown) {
									_this.startScan();
								} else {
									_this.stopScan();
								}
							}
						}
						// 处理标签数据广播
						else if (action === "uni.pda.uhf.data") {
							const uhfdata = intent.getStringExtra("uhfdata");
							_this.parseTagData(uhfdata);
						}
					}
				});
				
				this.main.registerReceiver(this.receiver, this.filter);
				console.log('广播接收器已注册');
				// #endif
			},
			
			/**
			 * 注销广播接收器
			 */
			unregisterReceiver() {
				// #ifdef APP-PLUS
				if (this.main && this.receiver) {
					this.main.unregisterReceiver(this.receiver);
					console.log('广播接收器已注销');
				}
				// #endif
			},
			
			/**
			 * 切换扫描状态
			 */
			toggleScan() {
				if (this.isScanning) {
					this.stopScan();
				} else {
					this.startScan();
				}
			},
			
			/**
			 * 开始扫描
			 */
			startScan() {
				if (this.isScanning) return;
				
				const result = plugin.startInventory();
				if (result) {
					this.isScanning = true;
					this.startTimer();
					console.log('开始盘点');
					
					uni.showToast({
						title: '开始扫描',
						icon: 'none',
						duration: 1000
					});
				} else {
					console.error('启动盘点失败');
					uni.showToast({
						title: '启动失败',
						icon: 'error'
					});
				}
			},
			
			/**
			 * 停止扫描
			 */
			stopScan() {
				if (!this.isScanning) return;
				
				const result = plugin.stopInventory();
				if (result) {
					this.isScanning = false;
					this.stopTimer();
					console.log('停止盘点');
					
					uni.showToast({
						title: '停止扫描',
						icon: 'none',
						duration: 1000
					});
				}
			},
			
			/**
			 * 开始计时
			 */
			startTimer() {
				this.elapsedTime = 0;
				this.timer = setInterval(() => {
					this.elapsedTime++;
				}, 1000);
			},
			
			/**
			 * 停止计时
			 */
			stopTimer() {
				if (this.timer) {
					clearInterval(this.timer);
					this.timer = null;
				}
			},
			
			/**
			 * 格式化时间
			 */
			formatTime(seconds) {
				const hours = Math.floor(seconds / 3600);
				const minutes = Math.floor((seconds % 3600) / 60);
				const secs = seconds % 60;
				
				return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
			},
			
			/**
			 * 解析标签数据
			 * 数据格式: [epc,tid,rssi,freq][epc,tid,rssi,freq]...
			 */
			parseTagData(uhfdata) {
				if (!uhfdata) return;
				
				console.log('接收标签数据:', uhfdata);
				
				// 使用正则表达式提取所有标签数据
				const tagPattern = /\[(.*?)\]/g;
				let match;
				
				while ((match = tagPattern.exec(uhfdata)) !== null) {
					const tagData = match[1].split(',');
					
					if (tagData.length >= 4) {
						const epc = tagData[0].trim();
						const tid = tagData[1].trim();
						const rssi = tagData[2].trim();
						const freq = tagData[3].trim();
						
						// 更新或添加标签
						this.updateTag(epc, tid, rssi, freq);
					}
				}
			},
			
			/**
			 * 更新标签数据
			 */
			updateTag(epc, tid, rssi, freq) {
				this.totalReadCount++;
				
				if (this.tagMap[epc]) {
					// 已存在，更新计数和RSSI
					this.tagMap[epc].count++;
					this.tagMap[epc].rssi = rssi;
					this.tagMap[epc].freq = freq;
				} else {
					// 新标签
					this.tagMap[epc] = {
						epc: epc,
						tid: tid,
						rssi: rssi,
						freq: freq,
						count: 1,
						timestamp: Date.now()
					};
					this.uniqueTagCount++;
				}
				
				// 更新列表（按时间倒序）
				this.updateTagList();
			},
			
			/**
			 * 更新标签列表
			 */
			updateTagList() {
				this.tagList = Object.values(this.tagMap).sort((a, b) => {
					return b.timestamp - a.timestamp;
				});
			},
			
			/**
			 * 清空数据
			 */
			clearData() {
				uni.showModal({
					title: '确认',
					content: '确定要清空所有数据吗？',
					success: (res) => {
						if (res.confirm) {
							this.tagMap = {};
							this.tagList = [];
							this.totalReadCount = 0;
							this.uniqueTagCount = 0;
							this.elapsedTime = 0;
							
							uni.showToast({
								title: '已清空',
								icon: 'success'
							});
						}
					}
				});
			},
			
			/**
			 * 导出数据
			 */
			exportData() {
				if (this.tagList.length === 0) {
					uni.showToast({
						title: '暂无数据',
						icon: 'none'
					});
					return;
				}
				
				// 生成CSV格式数据
				let csvContent = 'EPC,TID,RSSI,频率,读取次数\n';
				this.tagList.forEach(tag => {
					csvContent += `${tag.epc},${tag.tid},${tag.rssi},${tag.freq},${tag.count}\n`;
				});
				
				// 这里可以实现文件保存功能
				console.log('导出数据:', csvContent);
				
				uni.showToast({
					title: '导出成功',
					icon: 'success'
				});
			}
		}
	}
</script>

<style scoped>
	.content {
		display: flex;
		flex-direction: column;
		height: 100vh;
		background-color: #f5f5f5;
	}
	
	/* 统计信息 */
	.stats-container {
		display: flex;
		justify-content: space-around;
		padding: 30rpx 20rpx;
		background-color: #ffffff;
		margin: 20rpx;
		border-radius: 16rpx;
		box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.08);
	}
	
	.stat-item {
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	
	.stat-label {
		font-size: 24rpx;
		color: #999999;
		margin-bottom: 8rpx;
	}
	
	.stat-value {
		font-size: 36rpx;
		font-weight: bold;
		color: #333333;
	}
	
	/* 表格容器 */
	.table-container {
		flex: 1;
		margin: 0 20rpx 20rpx;
		background-color: #ffffff;
		border-radius: 16rpx;
		overflow: hidden;
		box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.08);
	}
	
	.table {
		display: flex;
		flex-direction: column;
		height: 100%;
	}
	
	/* 表头 */
	.table-header {
		display: flex;
		background: #4dc3a6;
		padding: 24rpx 20rpx;
		border-bottom: 2rpx solid #e0e0e0;
	}
	
	.table-header .table-cell {
		color: #ffffff;
		font-size: 28rpx;
		font-weight: bold;
	}
	
	/* 表格内容 */
	.table-body {
		flex: 1;
		overflow-y: auto;
	}
	
	.table-row {
		display: flex;
		padding: 24rpx 20rpx;
		border-bottom: 1rpx solid #f0f0f0;
		transition: background-color 0.2s;
	}
	
	.table-row:active {
		background-color: #f8f8f8;
	}
	
	.table-cell {
		display: flex;
		flex-direction: column;
		justify-content: center;
		padding: 0 10rpx;
		word-break: break-all;
	}
	
	.epc-text {
		font-size: 26rpx;
		color: #333333;
		font-weight: 500;
		margin-bottom: 8rpx;
	}
	
	.tid-text {
		font-size: 22rpx;
		color: #999999;
	}
	
	.cell-text {
		font-size: 26rpx;
		color: #666666;
		text-align: center;
	}
	
	/* 空状态 */
	.empty-state {
		display: flex;
		justify-content: center;
		align-items: center;
		padding: 100rpx 0;
	}
	
	.empty-text {
		font-size: 28rpx;
		color: #999999;
	}
	
	/* 底部按钮 */
	.button-container {
		display: flex;
		padding: 20rpx;
		background-color: #ffffff;
		box-shadow: 0 -4rpx 12rpx rgba(0, 0, 0, 0.08);
	}
	
	.btn {
		flex: 1;
		height: 88rpx;
		line-height: 88rpx;
		margin: 0 10rpx;
		border-radius: 12rpx;
		font-size: 30rpx;
		font-weight: bold;
		border: none;
		transition: all 0.3s;
	}
	
	.btn-start {
	    background: #3fbf5d;
		color: #ffffff;
	}
	
	.btn-start.btn-active {
		background: #ea3c2c;
	}
	
	.btn-stop {
		background-color: #a8a8a8;
		color: #ffffff;
	}
	
	.btn-clear {
		background-color: #5555ff;
		color: #ffffff;
	}
	
	.btn:active {
		opacity: 0.8;
		transform: scale(0.98);
	}
</style>
```



### 效果

![image-20251103135739613](18.厂家提供的UHF接口文档.assets/image-20251103135739613.png)