## 说明

使用的是urQrcode组件，现有的app中使用的是qrcode组件   但是这个组件是不支持app的，所以就换一个，

**但是现在的业务场景是微信扫码登录，所以这种方式根本就不适合，不适合微信扫码登录的登录流程  就当作是自己的学习吧！**



## 代码 

```vue
<template>
	<view class="login-container">
		<!-- Logo区域 -->
		<view class="logo-section">
			<!-- <image src="/static/image/home/logo.png" class="logo-img"></image> -->
			<text class="welcome-text">智慧食品仓库</text>
			<text class="sub-text">欢迎登录</text>
		</view>

		<view class="tab-container">
			<view 
				v-for="(tab, index) in tabs" 
				:key="index"
				:class="['tab-item', currentTab === index ? 'tab-active' : '']"
				@click="switchTab(index)"
			>
				<text :class="['tab-text', currentTab === index ? 'tab-text-active' : '']">
					{{ tab.name }}
				</text>
				<view v-if="currentTab === index" class="tab-line"></view>
			</view>
		</view>

		<!-- 登录内容区 -->
		<view class="form-container">
			<!-- 账号登录 -->
			<view v-if="currentTab === 0" class="form-content">
				<view class="input-group">
					<text class="input-label">手机号</text>
					<input 
						class="input-field" 
						type="number" 
						v-model="accountLogin.phone"
						placeholder="请输入手机号"
						placeholder-class="input-placeholder"
						:adjust-position="true"
					/>
				</view>

				<view class="input-group">
					<text class="input-label">密码</text>
					<view class="password-wrapper">
						<input 
							class="input-field" 
							:type="accountLogin.showPassword ? 'text' : 'password'"
							v-model="accountLogin.password"
							placeholder="请输入密码"
							placeholder-class="input-placeholder"
							:adjust-position="true"
						/>
						<image 
							class="eye-icon" 
							@click="togglePassword"
							:src="accountLogin.showPassword ? '/static/image/login/open_eyes.png' : '/static/image/login/close_eyes.png'"
						></image>
					</view>
				</view>

				<view class="remember-row">
					<checkbox-group @change="rememberChange">
						<label class="remember-label">
							<checkbox :checked="accountLogin.rememberPassword" class="remember-checkbox" />
							<text class="remember-text">记住密码</text>
						</label>
					</checkbox-group>
					<text class="forget-text" @click="forgetPassword">忘记密码?</text>
				</view>

				<button class="login-btn" @click="handleAccountLogin">登录</button>
			</view>

			<!-- 人脸登录 -->
			<view v-if="currentTab === 1" class="form-content face-content">
				<view class="face-scan-area">
					<image class="face-icon" src="/static/tabbar/mine.png"></image>
					<text class="face-tip">请将面部置于取景框内</text>
				</view>
				<button class="login-btn" @click="handleFaceLogin">开始人脸识别</button>
			</view>

			<!-- 扫码登录 -->
			<view v-if="currentTab === 2" class="form-content qrcode-content">
				<view class="qrcode-area">
					<view class="qrcode-wrapper">
						<uqrcode 
							ref="qrcode" 
							canvas-id="qrcode" 
							:value="qrcodeLogin.content" 
							:size="qrcodeLogin.size"
							:options="qrcodeLogin.options"
						></uqrcode>
					</view>
						
					<!-- 时间显示 -->
					<view class="timetxt">{{qrcodeLogin.timestamp}}</view>
					
					<text class="qrcode-tip">请使用手机扫描二维码登录</text>
				</view>
				<view class="refreshcode weui-flex_center" @click="refreshQrcode">
					<image src="/static/image/home/reload.png" style="width:25rpx;height: 25rpx; margin-right: 5px;"></image>
					刷新二维码
				</view>
			</view>

			<!-- 验证码登录 -->
			<view v-if="currentTab === 3" class="form-content vcode-original">
				<view class="login-inp weui-flex">
					<input 
						type="number" 
						placeholder="请输入手机号" 
						placeholder-style="color: #cccccc;" 
						v-model="vcodeLogin.phone"
						@input="handlePhoneInput"
						:adjust-position="true"
					/>
				</view>
				<view class="login-inp weui-flex" style="margin-top: 20rpx;" v-if="env_version!='release'">
					<input 
						type="text" 
						v-model="vcodeLogin.code" 
						placeholder="请输入验证码" 
						placeholder-style="color: #cccccc;"
						class="weui-flex__item"
						:adjust-position="true"
					/>
					<button v-if="vcodeLogin.btnDisabled" class="borderbtn noafter">{{vcodeLogin.btnText}}</button>
					<button v-else class="borderbtn borblue noafter" @click="showVerify">获取验证码</button>
				</view>

				<button class="fullbtn noafter" style="margin-top: 70rpx;" @click="handleVcodeLogin">立即登录</button>
				
				<!-- 验证码登录的协议勾选 -->
				<view style="margin: 30rpx 0 0 5rpx;">
					<view class="weui-flex">
						<checkbox-group @change="checkboxChange" class="agreement_radio">
							<label>
								<checkbox :checked="vcodeLogin.agreed" style="transform:scale(0.8)" />已阅读并同意
							</label>
							<text style="color: #60CABB;" @click="goagree">《服务协议》</text>
						</checkbox-group>
					</view>
				</view>
			</view>
		</view>
		
		<!-- 验证码组件 -->
		<Verify @success='onVerifySuccess' :mode="'pop'" :captchaType="'clickWord'" ref="verify"
			:imgSize="{width:'310px',height:'155px'}"></Verify>
	</view>
</template>

<script>
	import Verify from "@/pages/login/verify/verify.vue"
	import uqrcode from "@/components/Sansnn-uQRCode/components/uqrcode/uqrcode.vue"
	var moment = require("@/common/moment.min.js");
	const app = getApp();

	export default {
		components: {
			Verify,
			uqrcode
		},
		data() {
			return {
				env_version: app.globalData.env_version,
				tabs: [
					{ name: '账号登录', type: 'account' },
					{ name: '人脸登录', type: 'face' },
					{ name: '扫码登录', type: 'qrcode' },
					{ name: '验证码登录', type: 'vcode' }
				],
				currentTab: 0,
				
				// 账号登录相关数据
				accountLogin: {
					phone: '',
					password: '',
					showPassword: false,
					rememberPassword: false
				},
				
				// 二维码登录相关数据
				qrcodeLogin: {
					content: '',
					size: 260,
					timestamp: '',
					timer: null,
					refreshInterval: 1 * 60 * 1000, // 1分钟
					options: {
						margin: 10,
						background: '#ffffff',
						foreground: '#000000',
					}
				},
				
				// 验证码登录相关数据
				vcodeLogin: {
					phone: '',
					code: 'btkj',
					btnDisabled: true,
					btnText: '获取验证码',
					countdown: 300,
					timer: null,
					agreed: false
				},
				
				// 其他参数
				qrcodeuserid: '',
				qrcodegiftcode: ''
			}
		},
		
		onLoad(params) {
			this.qrcodeuserid = params.qrcodeuserid;
			this.qrcodegiftcode = params.qrcodegiftcode;
			
			// #ifdef MP-WEIXIN
			uni.checkSession({
				success: (res) => {
					if (res.errMsg != 'login:ok') {
						uni.login();
					}
				},
				fail: (res) => {
					console.log(JSON.stringify(res));
					uni.login();
				}
			});
			// #endif
		},
		
		onUnload() {
			this.clearQrcodeTimer();
			this.clearVcodeTimer();
		},
		
		methods: {
			switchTab(index) {
				this.currentTab = index;
				
				if (index === 2) {
					this.$nextTick(() => {
						this.initQrcode();
					});
				} else {
					
					this.clearQrcodeTimer();
				}
			},
			
			// ==================== 账号登录 ====================
			togglePassword() {
				this.accountLogin.showPassword = !this.accountLogin.showPassword;
			},
			
			rememberChange() {
				this.accountLogin.rememberPassword = !this.accountLogin.rememberPassword;
			},
			
			forgetPassword() {
				uni.showToast({
					title: '请联系管理员重置密码',
					icon: 'none'
				});
			},
			
			handleAccountLogin() {
				const { phone, password } = this.accountLogin;
				
				if (!phone) {
					return uni.showToast({ title: '请输入手机号', icon: 'none' });
				}
				
				if (!this.validatePhone(phone)) {
					return uni.showToast({ title: '请输入正确的手机号', icon: 'none' });
				}
				
				if (!password) {
					return uni.showToast({ title: '请输入密码', icon: 'none' });
				}
				
				if (password.length < 6) {
					return uni.showToast({ title: '密码长度不能少于6位', icon: 'none' });
				}
				
				uni.showLoading({ title: '登录中...' });
				
				const param = {
					zhtype: app.globalData.xcxtype,
					logintype: "loginByPassword",
					mobile: phone,
					password: password
				};
				
				app.globalData.applogin(param, () => {
					uni.hideLoading();
					this.loginCallback();
				});
			},
			
			// ==================== 人脸登录 ====================
			handleFaceLogin() {
				uni.showToast({
					title: '人脸识别功能开发中',
					icon: 'none'
				});
				// TODO: 实现人脸识别功能
			},
			
			// ==================== 二维码登录 ====================
			initQrcode() {
				console.log('初始化二维码');
				this.generateQrcode();
				this.startQrcodeTimer();
			},
			
			generateQrcode() {
				const timestamp = new Date().getTime();
				
				// TODO: 对接真实接口  uni.sm()
				// 临时虚拟数据
				const virtualUnionId = "88888888888888";
				const qrcodeData = virtualUnionId + timestamp;
				
				this.qrcodeLogin.content = qrcodeData;
				this.qrcodeLogin.timestamp = moment(timestamp).format("YYYY年MM月DD日 HH:mm:ss");
				
				console.log('二维码内容已更新:', this.qrcodeLogin.content);
			},
			
			startQrcodeTimer() {
				this.clearQrcodeTimer();
				this.qrcodeLogin.timer = setInterval(() => {
					this.generateQrcode();
				}, this.qrcodeLogin.refreshInterval);
			},
			
			clearQrcodeTimer() {
				if (this.qrcodeLogin.timer) {
					clearInterval(this.qrcodeLogin.timer);
					this.qrcodeLogin.timer = null;
				}
			},
			
			refreshQrcode() {
				console.log('手动刷新二维码');
				this.generateQrcode();
				this.startQrcodeTimer();
			},
			
			// ==================== 验证码登录 ====================
			handlePhoneInput(e) {
				const phone = e.detail.value;
				this.vcodeLogin.btnDisabled = !(phone && phone.charAt(0) == 1 && phone.length == 11);
			},
			
			showVerify() {
				this.$refs.verify.show();
			},
			
			onVerifySuccess(data) {
				setTimeout(() => {
					this.$refs.verify.hide();
				}, 1000);
				this.sendVcode(data.captchaVerification);
			},
			
			sendVcode(captchaVerification) {
				const phone = this.vcodeLogin.phone;
				
				if (!this.validatePhone(phone)) {
					return uni.msg("请输入正确的手机号");
				}
				
				uni.smaction((re, err) => {
					if (re.code == 200) {
						uni.msg("发送成功," + re.msg);
						this.startVcodeCountdown();
					} else if (re.code == 500) {
						this.vcodeLogin.btnDisabled = false;
						console.log(err);
					} else {
						this.vcodeLogin.btnDisabled = false;
						console.log('系统错误');
					}
				}, {
					mobile: phone,
					captchaVerification: captchaVerification
				}, {
					route: uni.svs.auth,
					action: 'login/loginsendvcode'
				});
			},
			
			startVcodeCountdown() {
				this.clearVcodeTimer();
				this.vcodeLogin.btnDisabled = true;
				
				this.vcodeLogin.timer = setInterval(() => {
					this.vcodeLogin.countdown--;
					this.vcodeLogin.btnText = this.vcodeLogin.countdown + ' 秒';
					
					if (this.vcodeLogin.countdown <= 0) {
						this.clearVcodeTimer();
						this.vcodeLogin.btnDisabled = false;
						this.vcodeLogin.btnText = "获取验证码";
						this.vcodeLogin.countdown = 300;
					}
				}, 1000);
			},
			
			clearVcodeTimer() {
				if (this.vcodeLogin.timer) {
					clearInterval(this.vcodeLogin.timer);
					this.vcodeLogin.timer = null;
				}
			},
			
			handleVcodeLogin() {
				if (!this.vcodeLogin.agreed) {
					return uni.msg("请先勾选协议");
				}
				
				if (!this.validatePhone(this.vcodeLogin.phone)) {
					return uni.msg("请输入正确的手机号");
				}
				
				if (!this.vcodeLogin.code) {
					return uni.msg("请输入正确的验证码");
				}
				
				uni.showLoading({ title: '登录中...' });
				
				const param = {
					zhtype: app.globalData.xcxtype,
					logintype: "loginByVcode",
					mobile: this.vcodeLogin.phone,
					vcode: this.vcodeLogin.code
				};
				
				app.globalData.applogin(param, () => {
					uni.hideLoading();
					this.loginCallback();
				});
			},
			
			checkboxChange() {
				this.vcodeLogin.agreed = !this.vcodeLogin.agreed;
			},
			
			goagree() {
				uni.navigateTo({
					url: "/pages/settings/user_agreement"
				});
			},
			
			// ==================== 工具方法 ====================
			validatePhone(phone) {
				const reg = /^1(3[0-9]|4[01456879]|5[0-35-9]|6[2567]|7[0-8]|8[0-9]|9[0-35-9])\d{8}$/;
				return phone.length === 11 && reg.test(phone);
			},
			
			loginCallback() {
				uni.reLaunch({
					url: "/pages/tabBar/rfidbind/index"
				});
			}
		}
	}
</script>

<style scoped>
page {
	background: #F5F7FA;
	height: 100vh;
}

.login-container {
	min-height: 100vh;
	background: #F5F7FA;
	display: flex;
	flex-direction: column;
	align-items: center;
	padding: 60rpx 40rpx 40rpx;
	box-sizing: border-box;
}

/* Logo区域 */
.logo-section {
	display: flex;
	flex-direction: column;
	align-items: center;
	margin-bottom: 60rpx;
}

.logo-img {
	width: 160rpx;
	height: 160rpx;
	margin-bottom: 24rpx;
}

.welcome-text {
	font-size: 40rpx;
	font-weight: bold;
	color: #333333;
	margin-bottom: 12rpx;
}

.sub-text {
	font-size: 28rpx;
	color: #999999;
}

/* Tab切换 */
.tab-container {
	width: 100%;
	max-width: 670rpx;
	display: flex;
	justify-content: space-around;
	background: #FFFFFF;
	border-radius: 12rpx;
	padding: 0 20rpx;
	margin-bottom: 40rpx;
	box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.05);
}

.tab-item {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	padding: 32rpx 0 24rpx;
	position: relative;
}

.tab-text {
	font-size: 30rpx;
	color: #666666;
	transition: all 0.3s;
}

.tab-text-active {
	color: #60CABB;
	font-weight: bold;
}

.tab-line {
	position: absolute;
	bottom: 0;
	width: 60rpx;
	height: 6rpx;
	background: #60CABB;
	border-radius: 3rpx;
}

/* 表单容器 */
.form-container {
	width: 93.6%;
	max-width: 670rpx;
	background: #FFFFFF;
	border-radius: 20rpx;
	padding: 50rpx 40rpx;
	box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.05);
	margin-bottom: 40rpx;
}

.form-content {
	width: 100%;
}

/* 输入框组 */
.input-group {
	margin-bottom: 40rpx;
}

.input-label {
	font-size: 28rpx;
	color: #333333;
	margin-bottom: 16rpx;
	display: block;
}

.input-field {
	width: 100%;
	height: 88rpx;
	border: 2rpx solid #E5E5E5;
	border-radius: 8rpx;
	padding: 0 24rpx;
	font-size: 28rpx;
	color: #333333;
	box-sizing: border-box;
}

.input-placeholder {
	color: #CCCCCC;
}

.password-wrapper {
	position: relative;
	width: 100%;
}

.eye-icon {
	width: 48rpx;
	height: 48rpx;
	position: absolute;
	right: 24rpx;
	top: 50%;
	transform: translateY(-50%);
}

/* 记住密码行 */
.remember-row {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 50rpx;
}

.remember-label {
	display: flex;
	align-items: center;
}

.remember-checkbox {
	transform: scale(0.8);
	margin-right: 8rpx;
}

.remember-text {
	font-size: 26rpx;
	color: #666666;
}

.forget-text {
	font-size: 26rpx;
	color: #60CABB;
}

/* 登录按钮 */
.login-btn {
	width: 100%;
	height: 88rpx;
	background: linear-gradient(135deg, #60CABB 0%, #4AB5A5 100%);
	border-radius: 44rpx;
	color: #FFFFFF;
	font-size: 32rpx;
	font-weight: bold;
	border: none;
	display: flex;
	align-items: center;
	justify-content: center;
}

.login-btn::after {
	border: none;
}

/* 人脸登录 */
.face-content {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.face-scan-area {
	display: flex;
	flex-direction: column;
	align-items: center;
	margin-bottom: 60rpx;
}

.face-icon {
	width: 160rpx;
	height: 160rpx;
	margin-bottom: 32rpx;
}

.face-tip {
	font-size: 28rpx;
	color: #999999;
}

/* 扫码登录 */
.qrcode-content {
	display: flex;
	flex-direction: column;
	align-items: center;
}

.qrcode-area {
	display: flex;
	flex-direction: column;
	align-items: center;
	margin-bottom: 30rpx;
	width: 100%;
}

/* 二维码容器 - 居中显示 */
.qrcode-wrapper {
	width: 460rpx;
	height: 460rpx;
	display: flex;
	align-items: center;
	justify-content: center;
	margin: 10px auto;
}

/* 时间显示 */
.timetxt {
	font-size: 30rpx;
	color: #70CFC2;
	text-align: center;
	line-height: 30px;
	margin: 10px 0;
}

.qrcode-tip {
	font-size: 28rpx;
	color: #999999;
	margin-top: 16rpx;
	text-align: center;
}

/* 刷新按钮 */
.refreshcode {
	padding: 20rpx 0;
	line-height: 30px;
	font-size: 28rpx;
	color: #60CABB;
	display: flex;
	align-items: center;
	justify-content: center;
	cursor: pointer;
}

.weui-flex_center {
	display: flex;
	align-items: center;
	justify-content: center;
}

/* 验证码登录 */
.vcode-original {
	/* 保持原有样式 */
}

.login-inp {
	align-items: center;
	border-bottom: 1px solid #f8f8f8;
	height: 70rpx;
	line-height: 70rpx;
	padding: 15rpx 0;
}

.weui-flex {
	display: flex;
}

.weui-flex__item {
	flex: 1;
}

.borderbtn {
	border: 1px solid #60CABB;
	color: #60CABB;
	background: #ffffff;
	font-size: 26rpx;
	padding: 14rpx 26rpx;
	border-radius: 40rpx;
	white-space: nowrap;
	height: auto;
	line-height: normal;
	margin-left: 10rpx;
}

.borblue {
	color: #60CABB;
	border-color: #60CABB;
}

.noafter::after {
	border: none;
}

.fullbtn {
	width: 100%;
	height: 88rpx;
	background: linear-gradient(135deg, #60CABB 0%, #4AB5A5 100%);
	border-radius: 50rpx;
	color: #FFFFFF;
	font-size: 32rpx;
	font-weight: bold;
	border: none;
	display: flex;
	align-items: center;
	justify-content: center;
}

.agreement_radio {
	display: flex;
	align-items: center;
}

.agreement_radio label {
	display: flex;
	align-items: center;
	font-size: 26rpx;
	color: #666666;
	margin-right: 8rpx;
}
</style>
```

## 效果

![image-20251201153039869](06.APP生成二维码.assets/image-20251201153039869.png)