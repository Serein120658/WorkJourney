## config-manager.js

```js
/**
 * UHF配置管理器
 * 管理不同场景下的UHF配置参数
 */

// 功率与距离对照表（近似值，实际会受环境影响）
const POWER_DISTANCE_MAP = [
	{ power: 500, distance: 0.01 }, // 与实际场景对比
	{ power: 1000, distance: 0.1 },
	{ power: 1500, distance: 0.15 },
	{ power: 2000, distance: 0.2 },
	{ power: 2200, distance: 0.22 },
	{ power: 2500, distance: 0.3 },
	{ power: 2800, distance: 0.4 },
	{ power: 3000, distance: 0.8 },
	{ power: 3300, distance: 1.0 }
];

// 预设场景配置
const PRESET_SCENES = {
	// 盘库场景 - 大功率、多标签、快速模式
	inventory: {
		name: '盘库',
		description: '适用于仓库盘点，大范围多标签扫描',
		power: 3300,
		zone: 6,
		inventoryMode: 2,  // 快速模式
		session: 1,        // 静态Session，适合大量静止标签
		audioTip: true
	},
	
	// 入库场景 - 中功率、批量绑定
	inbound: {
		name: '入库',
		description: '批量标签与货物关联',
		power: 2500,
		zone: 6,
		inventoryMode: 1,  // 正常模式
		session: 0,        // 动态Session
		audioTip: true
	},
	
	// 出库场景 - 中功率、验证模式
	outbound: {
		name: '出库',
		description: '验证标签并清零EPC',
		power: 2500,
		zone: 6,
		inventoryMode: 1,  // 正常模式
		session: 0,
		audioTip: true
	},
	
	// 查找场景 - 小功率、单标签、精确定位
	search: {
		name: '查找',
		description: '精确定位单个标签',
		power: 1500,
		zone: 6,
		inventoryMode: 0,  // 单标签模式
		session: 0,
		audioTip: true
	},
	
	// 验货场景 - 中等功率
	verify: {
		name: '验货',
		description: '货物验收检查',
		power: 2200,
		zone: 6,
		inventoryMode: 1,
		session: 0,
		audioTip: true
	}
};

const CONFIG_STORAGE_KEY = 'uhf_scene_configs';
const CURRENT_SCENE_KEY = 'uhf_current_scene';

class ConfigManager {
	constructor() {
		this.configs = {};
		this.currentScene = 'inventory';
		this.loadConfigs();
	}

	/**
	 * 加载配置
	 */
	loadConfigs() {
		try {
			// 从本地存储加载自定义配置
			const savedConfigs = uni.getStorageSync(CONFIG_STORAGE_KEY);
			const currentScene = uni.getStorageSync(CURRENT_SCENE_KEY);
			
			if (savedConfigs) {
				this.configs = JSON.parse(savedConfigs);
			} else {
				// 首次使用，使用预设配置
				this.configs = JSON.parse(JSON.stringify(PRESET_SCENES));
				this.saveConfigs();
			}
			
			if (currentScene) {
				this.currentScene = currentScene;
			}
			
			console.log('配置加载成功:', this.configs);
		} catch (error) {
			console.error('加载配置失败:', error);
			// 使用默认配置
			this.configs = JSON.parse(JSON.stringify(PRESET_SCENES));
		}
	}

	/**
	 * 保存配置
	 */
	saveConfigs() {
		try {
			uni.setStorageSync(CONFIG_STORAGE_KEY, JSON.stringify(this.configs));
			console.log('配置保存成功');
		} catch (error) {
			console.error('保存配置失败:', error);
		}
	}

	/**
	 * 保存当前场景
	 */
	saveCurrentScene() {
		try {
			uni.setStorageSync(CURRENT_SCENE_KEY, this.currentScene);
		} catch (error) {
			console.error('保存当前场景失败:', error);
		}
	}

	/**
	 * 获取场景配置
	 * @param {String} scene - 场景名称
	 * @returns {Object} 配置对象
	 */
	getConfig(scene) {
		return this.configs[scene] || this.configs.inventory;
	}

	/**
	 * 获取当前场景配置
	 * @returns {Object} 配置对象
	 */
	getCurrentConfig() {
		return this.getConfig(this.currentScene);
	}

	/**
	 * 设置场景配置
	 * @param {String} scene - 场景名称
	 * @param {Object} config - 配置对象
	 */
	setConfig(scene, config) {
		this.configs[scene] = {
			...this.configs[scene],
			...config
		};
		this.saveConfigs();
	}

	/**
	 * 切换当前场景
	 * @param {String} scene - 场景名称
	 */
	setCurrentScene(scene) {
		if (this.configs[scene]) {
			this.currentScene = scene;
			this.saveCurrentScene();
			console.log('切换场景:', scene);
		} else {
			console.error('场景不存在:', scene);
		}
	}

	/**
	 * 获取当前场景名称
	 * @returns {String}
	 */
	getCurrentScene() {
		return this.currentScene;
	}

	/**
	 * 获取所有场景列表
	 * @returns {Array}
	 */
	getAllScenes() {
		return Object.keys(this.configs).map(key => ({
			key: key,
			...this.configs[key]
		}));
	}

	/**
	 * 重置场景配置为预设值
	 * @param {String} scene - 场景名称
	 */
	resetConfig(scene) {
		if (PRESET_SCENES[scene]) {
			this.configs[scene] = JSON.parse(JSON.stringify(PRESET_SCENES[scene]));
			this.saveConfigs();
		}
	}

	/**
	 * 重置所有配置
	 */
	resetAllConfigs() {
		this.configs = JSON.parse(JSON.stringify(PRESET_SCENES));
		this.saveConfigs();
	}

	/**
	 * 功率转距离（米）
	 * @param {Number} power - 功率值 (0-3300)
	 * @returns {Number} 距离（米）
	 */
	powerToDistance(power) {
		// 线性插值计算
		for (let i = 0; i < POWER_DISTANCE_MAP.length - 1; i++) {
			const current = POWER_DISTANCE_MAP[i];
			const next = POWER_DISTANCE_MAP[i + 1];
			
			if (power >= current.power && power <= next.power) {
				const ratio = (power - current.power) / (next.power - current.power);
				return (current.distance + (next.distance - current.distance) * ratio).toFixed(1);
			}
		}
		
		// 超出范围
		if (power < POWER_DISTANCE_MAP[0].power) {
			return POWER_DISTANCE_MAP[0].distance.toFixed(1);
		}
		return POWER_DISTANCE_MAP[POWER_DISTANCE_MAP.length - 1].distance.toFixed(1);
	}

	/**
	 * 距离转功率
	 * @param {Number} distance - 距离（米）
	 * @returns {Number} 功率值
	 */
	distanceToPower(distance) {
		// 线性插值计算
		for (let i = 0; i < POWER_DISTANCE_MAP.length - 1; i++) {
			const current = POWER_DISTANCE_MAP[i];
			const next = POWER_DISTANCE_MAP[i + 1];
			
			if (distance >= current.distance && distance <= next.distance) {
				const ratio = (distance - current.distance) / (next.distance - current.distance);
				return Math.round(current.power + (next.power - current.power) * ratio);
			}
		}
		
		// 超出范围
		if (distance < POWER_DISTANCE_MAP[0].distance) {
			return POWER_DISTANCE_MAP[0].power;
		}
		return POWER_DISTANCE_MAP[POWER_DISTANCE_MAP.length - 1].power;
	}

	/**
	 * 获取功率距离对照表
	 * @returns {Array}
	 */
	getPowerDistanceMap() {
		return POWER_DISTANCE_MAP;
	}

	/**
	 * 获取盘点模式说明
	 * @param {Number} mode - 模式值
	 * @returns {String}
	 */
	getInventoryModeDesc(mode) {
		const modes = {
			0: '单标签模式 - 适合精确查找',
			1: '正常模式 - 平衡速度和准确性',
			2: '快速模式 - 适合大批量扫描'
		};
		return modes[mode] || '未知模式';
	}

	/**
	 * 获取Session说明
	 * @param {Number} session - Session值
	 * @returns {String}
	 */
	getSessionDesc(session) {
		const sessions = {
			0: 'Session 0 - 适合移动标签',
			1: 'Session 1 - 适合静止标签'
		};
		return sessions[session] || '未知Session';
	}
}

// 导出单例
export default new ConfigManager();
```

## sceneConfig.vue

```vue
<template>
	<view class="config-page">
		<!-- 场景选择 -->
		<view class="section">
			<view class="section-title">场景选择</view>
			<view class="scene-list">
				<view 
					v-for="scene in sceneList" 
					:key="scene.key"
					class="scene-item"
					:class="{ 'scene-active': currentScene === scene.key }"
					@click="selectScene(scene.key)"
				>
					<view class="scene-name">{{ scene.name }}</view>
					<view class="scene-desc">{{ scene.description }}</view>
				</view>
			</view>
		</view>

		<!-- 配置参数 -->
		<view class="section">
			<view class="section-title">
				{{ currentConfig.name }}场景配置
				<text class="reset-btn" @click="resetCurrentConfig">恢复默认</text>
			</view>

			<!-- 功率/距离设置 -->
			<view class="config-item">
				<view class="config-label">
					<text class="label-text">读取距离</text>
					<text class="label-value">{{ readDistance }}米</text>
				</view>
				<slider 
					class="config-slider"
					:value="currentConfig.power" 
					:min="500" 
					:max="3300" 
					:step="100"
					activeColor="#4dc3a6"
					backgroundColor="#e0e0e0"
					block-size="24"
					@change="onPowerChange"
				/>
				<view class="config-tips">
					<text>0.3m</text>
					<text class="power-value">功率: {{ currentConfig.power }}</text>
					<text>8m</text>
				</view>
			</view>

			<!-- 区域设置 -->
			<view class="config-item">
				<view class="config-label">
					<text class="label-text">区域代码</text>
					<text class="label-value">{{ getZoneName(currentConfig.zone) }}</text>
				</view>
				<picker 
					mode="selector" 
					:range="zoneList" 
					range-key="name"
					:value="zoneIndex"
					@change="onZoneChange"
				>
					<view class="picker-view">
						<text>{{ getZoneName(currentConfig.zone) }}</text>
						<text class="picker-arrow">›</text>
					</view>
				</picker>
			</view>

			<!-- 盘点模式 -->
			<view class="config-item">
				<view class="config-label">
					<text class="label-text">盘点模式</text>
					<text class="label-value">{{ getModeName(currentConfig.inventoryMode) }}</text>
				</view>
				<picker 
					mode="selector" 
					:range="modeList" 
					range-key="name"
					:value="modeIndex"
					@change="onModeChange"
				>
					<view class="picker-view">
						<text>{{ getModeName(currentConfig.inventoryMode) }}</text>
						<text class="picker-arrow">›</text>
					</view>
				</picker>
				<view class="config-desc">{{ configManager.getInventoryModeDesc(currentConfig.inventoryMode) }}</view>
			</view>

			<!-- Session设置 -->
			<view class="config-item">
				<view class="config-label">
					<text class="label-text">Session模式</text>
					<text class="label-value">Session {{ currentConfig.session }}</text>
				</view>
				<picker 
					mode="selector" 
					:range="sessionList" 
					range-key="name"
					:value="sessionIndex"
					@change="onSessionChange"
				>
					<view class="picker-view">
						<text>Session {{ currentConfig.session }}</text>
						<text class="picker-arrow">›</text>
					</view>
				</picker>
				<view class="config-desc">{{ configManager.getSessionDesc(currentConfig.session) }}</view>
			</view>

			<!-- 提示音 -->
			<view class="config-item">
				<view class="config-label">
					<text class="label-text">提示音</text>
				</view>
				<switch 
					:checked="currentConfig.audioTip" 
					color="#4dc3a6"
					@change="onAudioTipChange"
				/>
			</view>
		</view>

		<!-- 功率距离对照表 -->
		<view class="section">
			<view class="section-title">功率距离对照表</view>
			<view class="reference-table">
				<view class="table-header">
					<text class="table-cell">功率</text>
					<text class="table-cell">约读距离</text>
				</view>
				<view 
					v-for="item in powerDistanceMap" 
					:key="item.power"
					class="table-row"
				>
					<text class="table-cell">{{ item.power }}</text>
					<text class="table-cell">{{ item.distance }}m</text>
				</view>
			</view>
			<view class="table-note">
				* 实际读取距离会受标签类型、环境干扰、天线方向等因素影响
			</view>
		</view>

		<!-- 底部按钮 -->
		<view class="button-container">
			<button class="btn btn-reset" @click="resetAllConfigs">重置所有配置</button>
			<button class="btn btn-save" @click="saveAndApply">保存并应用</button>
		</view>
	</view>
</template>

<script>
import configManager from '@/common/config-manager.js';
import uhfManager from '@/common/uhf-manager.js';

export default {
	data() {
		return {
			configManager: configManager,
			currentScene: 'inventory',
			currentConfig: {},
			sceneList: [],
			
			// 区域列表
			zoneList: [
				{ value: 1, name: '美国' },
				{ value: 2, name: '欧洲' },
				{ value: 4, name: '韩国' },
				{ value: 6, name: '中国' },
				{ value: 8, name: '日本' }
			],
			
			// 模式列表
			modeList: [
				{ value: 0, name: '单标签' },
				{ value: 1, name: '正常' },
				{ value: 2, name: '快速' }
			],
			
			// Session列表
			sessionList: [
				{ value: 0, name: 'Session 0' },
				{ value: 1, name: 'Session 1' }
			],
			
			powerDistanceMap: []
		}
	},
	
	computed: {
		readDistance() {
			return configManager.powerToDistance(this.currentConfig.power);
		},
		
		zoneIndex() {
			return this.zoneList.findIndex(item => item.value === this.currentConfig.zone);
		},
		
		modeIndex() {
			return this.modeList.findIndex(item => item.value === this.currentConfig.inventoryMode);
		},
		
		sessionIndex() {
			return this.sessionList.findIndex(item => item.value === this.currentConfig.session);
		}
	},
	
	onLoad() {
		this.loadConfig();
		this.powerDistanceMap = configManager.getPowerDistanceMap();
	},
	
	methods: {
		/**
		 * 加载配置
		 */
		loadConfig() {
			this.currentScene = configManager.getCurrentScene();
			this.currentConfig = JSON.parse(JSON.stringify(configManager.getCurrentConfig()));
			this.sceneList = configManager.getAllScenes();
		},
		
		/**
		 * 选择场景
		 */
		selectScene(sceneKey) {
			this.currentScene = sceneKey;
			this.currentConfig = JSON.parse(JSON.stringify(configManager.getConfig(sceneKey)));
		},
		
		/**
		 * 功率改变
		 */
		onPowerChange(e) {
			this.currentConfig.power = e.detail.value;
		},
		
		/**
		 * 区域改变
		 */
		onZoneChange(e) {
			const index = e.detail.value;
			this.currentConfig.zone = this.zoneList[index].value;
		},
		
		/**
		 * 模式改变
		 */
		onModeChange(e) {
			const index = e.detail.value;
			this.currentConfig.inventoryMode = this.modeList[index].value;
		},
		
		/**
		 * Session改变
		 */
		onSessionChange(e) {
			const index = e.detail.value;
			this.currentConfig.session = this.sessionList[index].value;
		},
		
		/**
		 * 提示音改变
		 */
		onAudioTipChange(e) {
			this.currentConfig.audioTip = e.detail.value;
		},
		
		/**
		 * 获取区域名称
		 */
		getZoneName(zoneValue) {
			const zone = this.zoneList.find(item => item.value === zoneValue);
			return zone ? zone.name : '未知';
		},
		
		/**
		 * 获取模式名称
		 */
		getModeName(modeValue) {
			const mode = this.modeList.find(item => item.value === modeValue);
			return mode ? mode.name : '未知';
		},
		
		/**
		 * 重置当前场景配置
		 */
		resetCurrentConfig() {
			uni.showModal({
				title: '确认',
				content: '确定要恢复当前场景的默认配置吗？',
				success: (res) => {
					if (res.confirm) {
						configManager.resetConfig(this.currentScene);
						this.loadConfig();
						
						uni.showToast({
							title: '已恢复默认',
							icon: 'success'
						});
					}
				}
			});
		},
		
		/**
		 * 重置所有配置
		 */
		resetAllConfigs() {
			uni.showModal({
				title: '确认',
				content: '确定要重置所有场景的配置吗？',
				success: (res) => {
					if (res.confirm) {
						configManager.resetAllConfigs();
						this.loadConfig();
						
						uni.showToast({
							title: '所有配置已重置',
							icon: 'success'
						});
					}
				}
			});
		},
		
		/**
		 * 保存并应用配置
		 */
		saveAndApply() {
			// 保存配置
			configManager.setConfig(this.currentScene, this.currentConfig);
			configManager.setCurrentScene(this.currentScene);
			
			// 如果UHF已初始化，重新应用配置
			if (uhfManager.isReady()) {
				uhfManager.applyConfig(this.currentConfig);
			}
			
			uni.showToast({
				title: '配置已保存',
				icon: 'success',
				duration: 2000
			});
			
			// 延迟返回
			setTimeout(() => {
				uni.navigateBack();
			}, 1500);
		}
	}
}
</script>

<style scoped>
.config-page {
	min-height: 100vh;
	background-color: #f5f5f5;
	padding-bottom: 120rpx;
}

/* 区块 */
.section {
	margin: 20rpx;
	background-color: #ffffff;
	border-radius: 16rpx;
	padding: 30rpx;
	box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.06);
}

.section-title {
	font-size: 32rpx;
	font-weight: bold;
	color: #333333;
	margin-bottom: 20rpx;
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.reset-btn {
	font-size: 26rpx;
	color: #4dc3a6;
	font-weight: normal;
}

/* 场景列表 */
.scene-list {
	display: flex;
	flex-direction: column;
	gap: 16rpx;
}

.scene-item {
	padding: 24rpx;
	border-radius: 12rpx;
	background-color: #f8f8f8;
	border: 2rpx solid transparent;
	transition: all 0.3s;
}

.scene-item.scene-active {
	background-color: #e8f5f2;
	border-color: #4dc3a6;
}

.scene-name {
	font-size: 30rpx;
	font-weight: bold;
	color: #333333;
	margin-bottom: 8rpx;
}

.scene-desc {
	font-size: 24rpx;
	color: #999999;
}

/* 配置项 */
.config-item {
	margin-bottom: 32rpx;
}

.config-item:last-child {
	margin-bottom: 0;
}

.config-label {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 16rpx;
}

.label-text {
	font-size: 28rpx;
	color: #333333;
	font-weight: 500;
}

.label-value {
	font-size: 26rpx;
	color: #4dc3a6;
}

.config-slider {
	width: 100%;
	margin: 16rpx 0;
}

.config-tips {
	display: flex;
	justify-content: space-between;
	font-size: 22rpx;
	color: #999999;
	margin-top: 8rpx;
}

.power-value {
	color: #4dc3a6;
	font-weight: bold;
}

.picker-view {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 20rpx;
	background-color: #f8f8f8;
	border-radius: 8rpx;
	font-size: 28rpx;
	color: #333333;
}

.picker-arrow {
	font-size: 40rpx;
	color: #cccccc;
	font-weight: bold;
}

.config-desc {
	margin-top: 12rpx;
	font-size: 24rpx;
	color: #999999;
	line-height: 1.5;
}

/* 对照表 */
.reference-table {
	border: 1rpx solid #e0e0e0;
	border-radius: 8rpx;
	overflow: hidden;
}

.table-header {
	display: flex;
	background-color: #4dc3a6;
	padding: 20rpx;
}

.table-header .table-cell {
	flex: 1;
	text-align: center;
	font-size: 26rpx;
	font-weight: bold;
	color: #ffffff;
}

.table-row {
	display: flex;
	padding: 16rpx 20rpx;
	border-bottom: 1rpx solid #f0f0f0;
}

.table-row:last-child {
	border-bottom: none;
}

.table-cell {
	flex: 1;
	text-align: center;
	font-size: 26rpx;
	color: #666666;
}

.table-note {
	margin-top: 20rpx;
	font-size: 22rpx;
	color: #ff6b6b;
	line-height: 1.6;
}

/* 底部按钮 */
.button-container {
	position: fixed;
	bottom: 0;
	left: 0;
	right: 0;
	display: flex;
	padding: 20rpx;
	background-color: #ffffff;
	box-shadow: 0 -4rpx 12rpx rgba(0, 0, 0, 0.08);
}

.btn {
	flex: 1;
	height: 88rpx;
	line-height: 88rpx;
	margin: 0 10rpx;
	border-radius: 12rpx;
	font-size: 30rpx;
	font-weight: bold;
	border: none;
}

.btn-reset {
	background-color: #f0f0f0;
	color: #666666;
}

.btn-save {
	background-color: #4dc3a6;
	color: #ffffff;
}

.btn:active {
	opacity: 0.8;
}
</style>
```

## uhfSceneConfig.js

```js
/**
 * UHF场景配置管理器
 * 提供不同场景下的UHF配置参数，不做持久化处理
 * 
 * */
 
 
 /**
 * 配置参数说明:
 * @param {Number} id - 场景ID，唯一标识   @后续可以添加场景在页面中调用即可
 * @param {String} name -  场景名称
 * @param {String} description - 场景描述
 * @param {Number} power - 功率值，@取值范围 0-3300，数值越大读取距离越远
 * @param {Number} zone - 区域代码，6代表中国  @基本不改 
 * @param {Number} inventoryMode - @盘点模式
 * 						0 --  @普通模式
 * 						1 --  @新快速模式
 * 						2 --  @单标签模式   在软件控制单标签
 * 						3 --  @E7读停模式   
 * 						4 --  @E7智能温控模式
 * 						5 --  @多标签模式  高密度标签
 * @param {Number} session - Session模式，0=动态(适合移动标签)，1=静态(适合静止标签)
 * @param {Boolean} audioTip - 是否开启提示音 @基本不改
 */

// 场景配置数组  TODO  这部分需要经过实际测试确定功率范围
const SCENE_CONFIGS = [
	{
		id: 1,
		name: '入库',
		description: '批量标签与货物关联',
		power: 1800,  // TODO  这部分
		zone: 6,
		inventoryMode: 1,
		session: 1,
		audioTip: true
	},
	{
		id: 2,
		name: '出库',
		description: '验证标签并清零EPC',
		power: 2200,
		zone: 6,
		inventoryMode: 1,
		session: 1,
		audioTip: true
	},
	{
		id: 3,
		name: '盘库',
		description: '适用于仓库盘点，大范围多标签扫描',
		power: 3300,
		zone: 6,
		inventoryMode: 5,
		session: 0,
		audioTip: true
	},
	{
		id: 4,
		name: '单标签',
		description: '精确定位单个标签',
		power: 500,
		zone: 6,
		inventoryMode: 2,
		session: 1,
		audioTip: true
	},
	{
		id: 5,
		name: '验货',
		description: '验货',
		power: 2200,
		zone: 6,
		inventoryMode: 0,  // 
		session: 0,
		audioTip: true
	}
];

class UHFSceneConfig {
	/**
	 * 根据场景ID获取配置
	 * @param {Number} sceneId - 场景ID (1-5)，如果未提供则默认为1
	 * @returns {Object} 配置对象
	 */
	getConfig(sceneId) {
		// 容错处理：如果未提供场景ID，默认使用场景1（盘库）
		if (!sceneId) {
			console.warn('未提供场景ID，使用默认场景1（盘库）');
			sceneId = 1;
		}
		
		const config = SCENE_CONFIGS.find(item => item.id === sceneId);
		
		if (!config) {
			console.error(`场景ID ${sceneId} 不存在，使用默认场景1（盘库）`);
			return JSON.parse(JSON.stringify(SCENE_CONFIGS[0]));
		}
		
		// 返回配置的深拷贝，避免外部修改
		return JSON.parse(JSON.stringify(config));
	}

	/**
	 * 获取所有场景列表
	 * @returns {Array} 场景列表
	 */
	getAllScenes() {
		return JSON.parse(JSON.stringify(SCENE_CONFIGS));
	}

	/**
	 * 根据场景ID获取场景名称
	 * @param {Number} sceneId - 场景ID，如果未提供则默认为1
	 * @returns {String} 场景名称
	 */
	getSceneName(sceneId) {
		// 容错处理：如果未提供场景ID，默认使用场景1
		if (!sceneId) {
			sceneId = 1;
		}
		
		const config = SCENE_CONFIGS.find(item => item.id === sceneId);
		return config ? config.name : '盘库';
	}

	/**
	 * 验证场景ID是否有效
	 * @param {Number} sceneId - 场景ID
	 * @returns {Boolean}
	 */
	isValidSceneId(sceneId) {
		return SCENE_CONFIGS.some(item => item.id === sceneId);
	}
}

// 导出单例
export default new UHFSceneConfig();
```

## scanRetrieval.vue

```vue
<template>
	<view class="container">
		<!-- 标题行 -->
		<view class="header-row">
			<text class="title-text">选择出库日期:</text>
		</view>
		
		<!-- 出库日期选择 -->
		<picker 
			mode="date" 
			:value="selectedDate" 
			@change="onDateChange">
			<view class="retrieval-time">
				<text class="label-text">出库日期</text>
				<view class="date-value-container">
					<text class="date-value">{{ selectedDate }}</text>
					<text class="arrow-icon">></text>
				</view>
			</view>
		</picker>
		
		<view class="header-row">
			<text class="title-text">商品出库</text>
			<text class="title-text">已识别：{{ tagList.length }} 个</text>
		</view>

		<!-- 提示框 -->
		<view class="tip-box" v-if="showTip && !isScanning || tagList.length === 0">
			<text class="tip-text">按下手柄对准标签进行扫描</text>
		</view>
		
		<!-- 扫描到的标签列表 -->
		<view class="scan-result-section" v-if="tagList.length > 0">
			<scroll-view 
				class="tag-scroll-view" 
				scroll-y="true"
				:show-scrollbar="true"
				@touchmove.stop="">
				<view v-for="(tag, index) in tagList" :key="tag.epc" class="tag-item">
					<view class="tag-index">{{ index + 1 }}</view>
					<view class="tag-epc">{{ tag.epc }}</view>
					<view class="tag-info">
						<text class="tag-count">{{ tag.count }}次</text>
					</view>
				</view>
			</scroll-view>
		</view>
		
		<!-- 操作按钮区域 -->
		<view class="action-buttons" v-show="tagList.length > 0 && !isScanning">
			<button class="action-btn clear-btn" @click="clearTags">清空</button>
			<button class="action-btn confirm-btn" @click="confirmNext">数量无误，下一步</button>
		</view>
	</view>
</template>

<script>
import uhfManager from '@/common/uhfManager.js';
import uhfSceneConfig from '@/common/uhfSceneConfig.js';

export default {
	data() {
		return {
			currentSceneId: 2,
			isInitializing: false,
			isScanning: false,
			isStopping: false,
			theoreticalNumber: null,
			
			// 日期
			selectedDate: '',
			
			// 扫描数据
			tagMap: {},
			tagList: [],
			dataBuffer: [],
			updateTimer: null,
			pendingUpdates: false,
			
			// 控制提示信息显示
			showTip: true
		}
	},
	
	onLoad() {
		this.theoreticalNumber = 50;
		// 初始化日期为当前日期
		this.selectedDate = this.getCurrentDate();
	},
	
	onShow() {
		console.log('页面显示');
		this.$nextTick(() => {
			this.asyncInitUHF();
		});
	},
	
	onHide() {
		console.log('页面隐藏');
		this.stopScan();
		this.uninitUHF();
	},
	
	onUnload() {
		console.log('页面卸载');
		this.stopScan();
		this.uninitUHF();
	},
	
	methods: {
		/**
		 * 获取当前日期
		 */
		getCurrentDate() {
			const date = new Date();
			const year = date.getFullYear();
			const month = String(date.getMonth() + 1).padStart(2, '0');
			const day = String(date.getDate()).padStart(2, '0');
			return `${year}-${month}-${day}`;
		},
		
		/**
		 * 日期选择改变
		 */
		onDateChange(e) {
			this.selectedDate = e.detail.value;
			console.log('选择的日期:', this.selectedDate);
			
			uni.showToast({
				title: '日期已更新',
				icon: 'success',
				duration: 1500
			});
		},
		
		/**
		 * 异步初始化UHF
		 */
		async asyncInitUHF() {
			if (uhfManager.isReady()) {
				const config = uhfSceneConfig.getConfig(this.currentSceneId);
				uhfManager.applyConfig(config);
				this.setupCallbacks();
				return;
			}
			
			this.isInitializing = true;
			setTimeout(() => {
				this.initUHF();
				this.isInitializing = false;
			}, 100);
		},
		
		/**
		 * 初始化UHF
		 */
		initUHF() {
			const config = uhfSceneConfig.getConfig(this.currentSceneId);
			console.log('使用盘库场景配置:', config);
			
			const result = uhfManager.init(config);
			
			if (result) {
				console.log('UHF初始化成功');
				this.setupCallbacks();
			} else {
				console.error('UHF初始化失败');
				uni.showToast({
					title: '设备初始化失败',
					icon: 'error',
					duration: 2000
				});
			}
		},
		
		/**
		 * 设置回调函数
		 */
		setupCallbacks() {
			uhfManager.setOnTagDataCallback((uhfdata) => {
				if (this.isScanning && !this.isStopping) {
					this.parseTagData(uhfdata);
				}
			});
			
			uhfManager.setOnKeyScanCallback((isKeyDown) => {
				if (isKeyDown) {
					this.showTip = false;
					this.startScan();
				} else {
					this.stopScan();
				}
			});
		},
		
		/**
		 * 卸载UHF
		 */
		uninitUHF() {
			uhfManager.uninit();
			this.stopUpdateTimer();
		},
		
		/**
		 * 开始扫描
		 */
		startScan() {
			if (this.isScanning) return;
			
			if (this.isInitializing) {
				uni.showToast({
					title: '设备初始化中,请稍候',
					icon: 'none'
				});
				return;
			}
			
			const result = uhfManager.startScan();
			if (result) {
				this.isScanning = true;
				this.isStopping = false;
				this.dataBuffer = [];
				this.startUpdateTimer();
				console.log('开始扫描');
				
				uni.showToast({
					title: '开始扫描',
					icon: 'none',
					duration: 1000
				});
			} else {
				console.error('启动扫描失败');
				uni.showToast({
					title: '启动失败',
					icon: 'error'
				});
			}
		},
		
		/**
		 * 停止扫描
		 */
		stopScan() {
			if (!this.isScanning || this.isStopping) return;
			
			this.isStopping = true;
			console.log('准备停止扫描');
			
			const result = uhfManager.stopScan();
			
			if (result) {
				this.stopUpdateTimer();
				
				setTimeout(() => {
					if (this.dataBuffer.length > 0) {
						this.processBatchData();
					}
					
					this.updateTagListFast();
					
					this.isScanning = false;
					this.isStopping = false;
					
					console.log('停止扫描');
					uni.showToast({
						title: '停止扫描',
						icon: 'none',
						duration: 1000
					});
					
					this.checkScanComplete();
				}, 0);
			} else {
				this.isStopping = false;
			}
		},
		
		/**
		 * 启动UI更新定时器
		 */
		startUpdateTimer() {
			this.stopUpdateTimer();
			this.updateTimer = setInterval(() => {
				if (this.pendingUpdates) {
					this.processBatchData();
					this.updateTagListFast();
					this.pendingUpdates = false;
				}
			}, 300);
		},
		
		/**
		 * 停止UI更新定时器
		 */
		stopUpdateTimer() {
			if (this.updateTimer) {
				clearInterval(this.updateTimer);
				this.updateTimer = null;
			}
		},
		
		/**
		 * 解析标签数据
		 */
		parseTagData(uhfdata) {
			console.log("收到的数据:", uhfdata);
			if (!uhfdata || this.isStopping) return;
			
			const tagPattern = /\[(.*?)\]/g;
			let match;
			
			while ((match = tagPattern.exec(uhfdata)) !== null) {
				const tagData = match[1].split(',');
				
				if (tagData.length >= 4) {
					this.dataBuffer.push({
						epc: tagData[0].trim(),
						tid: tagData[1].trim(),
						rssi: tagData[2].trim(),
						freq: tagData[3].trim()
					});
					
					this.pendingUpdates = true;
				}
			}
		},
		
		/**
		 * 批量处理缓冲区数据
		 */
		processBatchData() {
			if (this.dataBuffer.length === 0) return;
			
			const buffer = this.dataBuffer.splice(0);
			
			buffer.forEach(tag => {
				if (this.tagMap[tag.epc]) {
					this.tagMap[tag.epc].count++;
					this.tagMap[tag.epc].rssi = tag.rssi;
					this.tagMap[tag.epc].freq = tag.freq;
					this.tagMap[tag.epc].timestamp = Date.now();
				} else {
					this.$set(this.tagMap, tag.epc, {
						epc: tag.epc,
						tid: tag.tid,
						rssi: tag.rssi,
						freq: tag.freq,
						count: 1,
						timestamp: Date.now()
					});
				}
			});
		},
		
		/**
		 * 快速更新标签列表
		 */
		updateTagListFast() {
			this.tagList = Object.values(this.tagMap);
		},
		
		/**
		 * 检查扫描是否完成
		 */
		checkScanComplete() {
			if (this.tagList.length > 0) {
				this.showTip = false;
			}
		},
		
		/**
		 * 清空已扫描的标签
		 */
		clearTags() {
			uni.showModal({
				title: '确认清空',
				content: '确定要清空所有已扫描的标签吗?',
				success: (res) => {
					if (res.confirm) {
						this.tagMap = {};
						this.tagList = [];
						this.dataBuffer = [];
						this.showTip = true;
						
						uni.showToast({
							title: '已清空',
							icon: 'success',
							duration: 1500
						});
					}
				}
			});
		},
		
		/**
		 * 确认之后下一步
		 */
		confirmNext() {
			if (this.tagList.length === 0) {
				uni.showToast({
					title: '请先扫描标签',
					icon: 'none',
					duration: 2000
				});
				return;
			}
			
			console.log('确认出库数据:', {
				date: this.selectedDate,
				tags: this.tagList,
				count: this.tagList.length
			});
			
			uni.showToast({
				title: '出库数据已确认',
				icon: 'success',
				duration: 1500
			});
		}
	}
}
</script>

<style scoped>
.container {
	background-color: #ffffff;
	min-height: 100vh;
	padding: 20rpx;
}

.header-row {
	display: flex;
	justify-content: space-between;
	margin-bottom: 10rpx;
}

.title-text {
	font-size: 28rpx;
	color: #333333;
	font-weight: 500;
}

.retrieval-time {
	background-color: #f5f5f5;
	border-radius: 12rpx;
	padding: 25rpx;
	margin-bottom: 30rpx;
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.label-text {
	font-size: 28rpx;
	color: #333333;
}

.date-value-container {
	display: flex;
	align-items: center;
	gap: 10rpx;
}

.date-value {
	font-size: 28rpx;
	color: #666666;
}

.arrow-icon {
	font-size: 28rpx;
	color: #999999;
}

.tip-box {
	background: rgba(241, 144, 24, 0.2);
	border-radius: 12rpx;
	padding: 25rpx;
	margin-bottom: 30rpx;
}

.tip-text {
	font-size: 26rpx;
	color: #E65100;
	text-align: center;
	display: block;
}

.action-buttons {
	position: fixed;
	bottom: 10rpx;
	left: 20rpx;
	right: 20rpx;
	display: flex;
	gap: 20rpx;
	background-color: #ffffff;
	z-index: 100;
	padding: 20rpx 0;
}

.action-btn {
	height: 80rpx;
	line-height: 80rpx;
	border-radius: 12rpx;
	font-size: 28rpx;
	border: none;
}

.action-btn::after {
	border: none;
}

.clear-btn {
	background-color: #f5aca5;
	color: #ff0000;
	width: 220rpx;
}

.confirm-btn {
	flex: 1;
	background-color: #1da99e;
	color: #FFFFFF;
}

.scan-result-section {
	background-color: #FFFFFF;
	border-radius: 16rpx;
	padding: 20rpx 0;
	margin-bottom: 180rpx;
	height: calc(100vh - 400rpx);
	overflow: hidden;
}

.tag-scroll-view {
	height: 100%;
}

.tag-item {
	display: flex;
	align-items: center;
	padding: 20rpx 0;
	margin: 10rpx 0;
	border: 2rpx solid #d9d9d9;
	border-radius: 10rpx;
}

.tag-index {
	width: 60rpx;
	font-size: 24rpx;
	color: #999999;
	text-align: center;
}

.tag-epc {
	flex: 1;
	font-size: 24rpx;
	color: #333333;
	font-family: monospace;
	margin: 0 20rpx;
}

.tag-info {
	display: flex;
	gap: 20rpx;
	align-items: center;
}

.tag-count {
	font-size: 28rpx;
	color: #8e918e;
	margin-right: 50rpx;
}
</style>
```

说明这个效果其实还不错，但是和原型不一致，所以就换一个喽！

