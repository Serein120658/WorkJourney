# Git Commit 提交规范指南

## 📋 规范概述

本规范基于 [Conventional Commits](https://www.conventionalcommits.org/) 约定，帮助团队编写清晰、一致的提交信息。

## 🎯 提交信息格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

### 基本格式说明

- **type**: 提交类型(必填)
- **scope**: 影响范围(可选)
- **subject**: 简短描述(必填)
- **body**: 详细描述(可选)
- **footer**: 备注信息(可选)

------

## 📝 Type 类型说明

| 类型         | 说明                                | 示例                              |
| ------------ | ----------------------------------- | --------------------------------- |
| **feat**     | 新增功能                            | `feat: 添加用户登录功能`          |
| **fix**      | 修复 Bug                            | `fix: 修复购物车计算错误`         |
| **docs**     | 文档变更                            | `docs: 更新 API 文档`             |
| **style**    | 代码格式(不影响代码运行)            | `style: 格式化代码缩进`           |
| **refactor** | 重构(既不是新增功能,也不是修复 bug) | `refactor: 重构用户认证模块`      |
| **perf**     | 性能优化                            | `perf: 优化数据库查询性能`        |
| **test**     | 增加测试                            | `test: 添加用户模块单元测试`      |
| **chore**    | 构建过程或辅助工具的变动            | `chore: 更新依赖包版本`           |
| **build**    | 影响构建系统或外部依赖              | `build: 升级 webpack 到 5.0`      |
| **ci**       | CI/CD 配置文件和脚本的变动          | `ci: 添加 GitHub Actions 配置`    |
| **revert**   | 回退之前的提交                      | `revert: 回退 feat: 添加支付功能` |

------

## 🔍 Scope 范围(可选)

Scope 用于说明 commit 影响的范围,可以是:

- **模块名**: `auth`, `user`, `order`, `payment`
- **功能名**: `login`, `cart`, `checkout`
- **文件名**: `README`, `package.json`
- **组件名**: `Button`, `Header`, `Footer`

**示例**:

```
feat(auth): 添加第三方登录功能
fix(cart): 修复商品数量更新问题
docs(README): 更新安装说明
```

------

## ✍️ Subject 主题

主题是 commit 的简短描述:

### 规则

- 使用**祈使句**,现在时态:"添加"而不是"已添加"或"添加了"
- 不要大写首字母(英文)
- 结尾不加句号
- 简洁明了,建议不超过 50 个字符

### 良好示例 ✅

```
feat: 添加用户头像上传功能
fix: 修复登录页面样式错位
docs: 更新贡献指南
```

![image-20251117110736720](08.提交代码规范文档.assets/image-20251117110736720.png)



### 不良示例 ❌

```
添加了一个新的用户头像上传的功能。
Fix bug
update
```

------

## 📄 Body 正文(可选)

Body 是对本次 commit 的详细描述:

- 说明**为什么**做这个改动
- 解释**如何**解决问题
- 与之前行为的**对比**
- 注意事项

**示例**:

```
fix(auth): 修复 JWT token 过期时间计算错误

之前的计算逻辑使用了错误的时间单位,导致 token 
在 1 小时后就过期。现在修改为正确的 24 小时。

- 修改 generateToken 函数的 expiresIn 参数
- 添加相关单元测试
- 更新 API 文档说明
```

------

## 🏷️ Footer 页脚(可选)

Footer 主要用于两种情况:

### 1. 不兼容变动

以 `BREAKING CHANGE:` 开头,说明重大变更:

```
feat(api): 重构用户 API 接口

BREAKING CHANGE: 
用户 API 的响应格式已更改。
之前: { user: {...} }
现在: { data: { user: {...} } }
```

### 2. 关闭 Issue

```
fix(login): 修复验证码无法显示的问题

Closes #123
Closes #456, #789
```

------

## 💡 完整示例

### 示例 1: 简单提交

```
feat: 添加暗黑模式切换功能
```

### 示例 2: 带 scope

```
fix(payment): 修复支付金额四舍五入错误
```

### 示例 3: 完整格式

```
feat(user): 添加用户资料编辑功能

实现用户个人信息的编辑和更新功能,包括:
- 头像上传和裁剪
- 基本信息修改(昵称、邮箱、手机号)
- 表单验证和错误提示
- 数据持久化到后端

Closes #234
```

### 示例 4: 重大变更

```
refactor(api)!: 重构 RESTful API 接口

BREAKING CHANGE:
所有 API 端点从 /api/v1/* 迁移到 /api/v2/*
响应格式统一为 { code, data, message }
```

------

## 🚀 快速开始

### 1. 养成习惯

每次提交前问自己:

- 这次改动的**类型**是什么?
- 这次改动**做了什么**?
- 能否用**一句话**清楚说明?

### 2. 常用模板

```bash
# 新功能
git commit -m "feat: 添加XXX功能"
git commit -m "feat(模块): 添加XXX功能"

# 修复 Bug
git commit -m "fix: 修复XXX问题"
git commit -m "fix(模块): 修复XXX问题"

# 文档
git commit -m "docs: 更新XXX文档"

# 样式/格式
git commit -m "style: 格式化代码"

# 重构
git commit -m "refactor: 重构XXX模块"

# 性能优化
git commit -m "perf: 优化XXX性能"

# 测试
git commit -m "test: 添加XXX测试"

# 构建/工具
git commit -m "chore: 更新依赖包"
```

### 3. 使用工具辅助

可以使用以下工具帮助规范提交:

- **Commitizen**: 交互式生成符合规范的提交信息
- **Commitlint**: 检查提交信息是否符合规范
- **Husky**: Git hooks 工具,在提交前自动检查

```bash
# 安装 commitizen
npm install -g commitizen cz-conventional-changelog

# 使用 commitizen 提交
git cz
```

------

## ✅ 检查清单

提交前检查:

- [ ] Type 类型是否正确?
- [ ] Subject 是否简洁明了?
- [ ] 是否使用了祈使句?
- [ ] 是否需要添加 Scope?
- [ ] 是否需要详细的 Body 说明?
- [ ] 是否有关联的 Issue 需要关闭?
- [ ] 是否是破坏性变更(需要 BREAKING CHANGE)?

------

## 📚 参考资源

- [Conventional Commits 官方网站](https://www.conventionalcommits.org/)
- [Angular 提交规范](https://github.com/angular/angular/blob/master/CONTRIBUTING.md#commit)
- [Commitizen GitHub](https://github.com/commitizen/cz-cli)

------

**记住**: 好的提交信息是写给未来的自己和团队成员看的,清晰的提交历史能大大提升协作效率! 🎉