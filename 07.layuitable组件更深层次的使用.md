说明：在之前的学习中，参考例子实现了table的初始化，根据条件请求接口重新获取数据

现在去深入学习表格对应的编辑、删除等   与layuitable去联合实现

## layuitable深入浅出

### 目标：

学习layuitable，在数据的每一行加上编辑、删除按钮， 参考示例消息id：`big_dataset_new.getList`

 编辑操作具体的流程

删除操作对应的逻辑:

### 步骤（末尾添加今日代码）：

1. 如何在渲染好的单元格添加编辑、删除按钮？

   - 通过阅读官方文档 首先 需要在渲染table(js文件当中)的时候添加一个字段 

   {fixed: 'right', title: '操作', width: 134, minWidth: 125, templet: '#myrule_layuitable'}

   - 在html文件中添加如下：切记id与上面的对应

   ```html
   <script type="text/html" id="myrule_layuitable">
       <div class="layui-clear-space">
           <a class="layui-btn layui-btn-xs" lay-event="edit" lay-perm="sys:dataset:edit">编辑</a>
           <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del" lay-perm="sys:dataset:del">删除</a>
       </div>
   </script>
   ```

2. 如何触发？ 通过阅读官方文档 发现

   可以使用table.on(tool("#tableId")),function(obj){}

   通过obj.event 获取点击了谁

3. 触发后新页面如何传递相应的数据(也就是回显)？

   在上面的点击事件中添加如下代码：

   ```js
   layer.open({
           title: '编辑 - id:'+ data.id,
           type: 1,
           area: ['80%','80%'],
           content: '<div style="padding: 16px;">自定义表单元素</div>'
         });
   ```

   这里的content  理论上不可能使用纯标签的形式  按照之前开发的前端的逻辑  是需要跳转页面

   当然了  也可以使用弹出层(这是  vue框架(dialog)  uni-app也适用)

### 回显(重要)

在前面的3中，不难发现弹出层主要所展现的是content里面的内容

两种方法传递数据

1. 直接将得到的整条数据传递过去  （好处，不用调用接口，数据不是最新的）
2. 地址传递id 再次请求接口获取数据   （好处 数据是最新的，但是需要回显的数据来自多张表的时候 与数据库的交互量就比较大）采用的比较多
3. 传递id   异步获取数据  渲染

## 遇到的难点

参考示例：`big_datasetadd.js`

### 1、content  传参格式

```js
content: 'html/bigdata/big_datasetadd.html?v=' + Arg("v") + '&type=' + "update" + '&mid=' + Arg("mid") + "&id=" + updateId,
```

地址栏传参数到页面  是如何绑定的给相应的标签的？如果 只是传递id 重新编写请求接口

通过查看才得知  它是通过`Arg(" ")` 函数去拿到地址栏传递过来的参数的

#### 疑问：

1. 为什么需要加  `Arg("V")`  `Arg("mid")`  注意到这两个点，主要是xml  含有did 等参数 不知是否与之对应

#### 易错点

1. 传参格式如果像上面的content那样的话  需要指定 type为2

2. 需要结合**jQuery.getparent()**.layer.open   来使用   否则会出现下面的错误：

   ![image-20250729154959368](07.layuitable组件更深层次的使用.assets/image-20250729154959368.png)

3. 



### 2、Promise 异步请求

 之所以说难是因为从来没有用过  且代码不易读懂



## 页面实现

修改原有的content   创建新的页面   需要留意的是页面该如何写？

![image-20250729164909569](07.layuitable组件更深层次的使用.assets/image-20250729164909569.png)







## 今日代码

